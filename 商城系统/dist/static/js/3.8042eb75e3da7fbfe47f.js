webpackJsonp([3],{"5zde":function(e,t,r){r("zQR9"),r("qyJz"),e.exports=r("FeBl").Array.from},Gu7T:function(e,t,r){"use strict";t.__esModule=!0;var a,s=r("c/Tr"),n=(a=s)&&a.__esModule?a:{default:a};t.default=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return(0,n.default)(e)}},"QNL/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Gu7T"),s=r.n(a),n=r("Xxa5"),o=r.n(n),i=r("exGp"),l=r.n(i),c={mixins:[{data:function(){return{rolesList:[],addDialogVisible:!1,addForm:{roleName:"",roleDesc:""},addFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},editDialogVisible:!1,editForm:{roleName:"",roleDesc:""},editFormRules:{roleName:[{required:!0,message:"请填写角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请填写角色描述",trigger:"blur"}]},setRightDialogVisible:!1,rightTree:[],treeProp:{label:"authName",children:"children"},defaultCheckedKeys:[],roleId:""}},created:function(){this.getRolesList()},methods:{getRolesList:function(){var e=this;return l()(o.a.mark(function t(){var r,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("roles");case 2:if(r=t.sent,200===(a=r.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取角色列表失败！"));case 6:e.rolesList=a.data;case 7:case"end":return t.stop()}},t,e)}))()},addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addRoles:function(){var e,t=this;this.$refs.addFormRef.validate((e=l()(o.a.mark(function e(r){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("roles",t.addForm);case 4:if(a=e.sent,201===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("添加角色失败！"));case 8:t.$message.success("添加角色成功！"),t.getRolesList(),t.addDialogVisible=!1;case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},showEditDialog:function(e){var t=this;return l()(o.a.mark(function r(){var a,s;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("roles/"+e);case 2:if(a=r.sent,200===(s=a.data).meta.status){r.next=6;break}return r.abrupt("return",t.$message.error("查询角色信息失败！"));case 6:t.editForm=s.data,t.editDialogVisible=!0;case 8:case"end":return r.stop()}},r,t)}))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},saveRolesInfo:function(){var e,t=this;this.$refs.editFormRef.validate((e=l()(o.a.mark(function e(r){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.put("roles/"+t.editForm.roleId,t.editForm);case 4:if(a=e.sent,200===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("编辑角色信息失败！"));case 8:t.$message.success("编辑角色信息成功！"),t.getRolesList(),t.editDialogVisible=!1;case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},removeRoles:function(e){var t=this;return l()(o.a.mark(function r(){var a;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===r.sent){r.next=5;break}return r.abrupt("return",t.$message({type:"info",message:"已取消删除"}));case 5:return r.next=7,t.$http.delete("roles/"+e);case 7:if(a=r.sent,200===a.data.meta.status){r.next=11;break}return r.abrupt("return",t.$message.error("删除角色失败！"));case 11:t.$message.success("删除角色成功！"),t.getRolesList();case 13:case"end":return r.stop()}},r,t)}))()},removeRight:function(e,t){var r=this;return l()(o.a.mark(function a(){var s,n;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.$confirm("此操作将永久删除该权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===a.sent){a.next=5;break}return a.abrupt("return",r.$message({type:"info",message:"已取消删除"}));case 5:return a.next=7,r.$http.delete("roles/"+e.id+"/rights/"+t);case 7:if(s=a.sent,200===(n=s.data).meta.status){a.next=11;break}return a.abrupt("return",r.$message.error("删除权限失败！"));case 11:e.children=n.data;case 12:case"end":return a.stop()}},a,r)}))()},showSetRightDialog:function(e){var t=this;return l()(o.a.mark(function r(){var a,s,n;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.roleId=e.id,r.next=3,t.$http.get("rights/tree");case 3:if(a=r.sent,200===(s=a.data).meta.status){r.next=7;break}return r.abrupt("return",t.$message.error("获取所有权限失败！"));case 7:t.rightTree=s.data,n=[],t.getLeafId(e,n),t.defaultCheckedKeys=n,t.setRightDialogVisible=!0;case 12:case"end":return r.stop()}},r,t)}))()},getLeafId:function(e,t){var r=this;if(!e.children)return t.push(e.id);e.children.forEach(function(e){return r.getLeafId(e,t)})},saveRights:function(){var e=this;return l()(o.a.mark(function t(){var r,a,n,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$refs.tree.getCheckedKeys(),a=e.$refs.tree.getHalfCheckedKeys(),n=[].concat(s()(r),s()(a)).join(","),t.next=5,e.$http.post("roles/"+e.roleId+"/rights",{rids:n});case 5:if(i=t.sent,200===i.data.meta.status){t.next=9;break}return t.abrupt("return",e.$message.error("分配权限失败！"));case 9:e.$message.success("分配权限成功！"),e.getRolesList(),e.setRightDialogVisible=!1;case 12:case"end":return t.stop()}},t,e)}))()}}}]},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("角色列表")])],1),e._v(" "),r("el-card",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加角色")]),e._v(" "),r("el-table",{attrs:{data:e.rolesList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(a,s){return r("el-row",{key:a.id,style:{"border-bottom":"1px solid #eee","border-top":0===s?"1px solid #eee":""}},[r("el-col",{attrs:{span:5}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){e.removeRight(t.row,a.id)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),r("el-col",{attrs:{span:19}},e._l(a.children,function(a,s){return r("el-row",{key:a.id,style:{"border-top":0===s?"":"1px solid #eee"}},[r("el-col",{attrs:{span:6}},[r("el-tag",{attrs:{type:"success",closable:""},on:{close:function(r){e.removeRight(t.row,a.id)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),r("el-col",{attrs:{span:18}},e._l(a.children,function(a){return r("el-tag",{key:a.id,attrs:{type:"warning",closable:""},on:{close:function(r){e.removeRight(t.row,a.id)}}},[e._v(e._s(a.authName))])}))],1)}))],1)})}}])}),e._v(" "),r("el-table-column",{attrs:{type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){e.showEditDialog(t.row.id)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){e.removeRoles(t.row.id)}}},[e._v("删除")]),e._v(" "),r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){e.showSetRightDialog(t.row)}}},[e._v("分配权限")])]}}])})],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加角色",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.addForm.roleName,callback:function(t){e.$set(e.addForm,"roleName",t)},expression:"addForm.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.addForm.roleDesc,callback:function(t){e.$set(e.addForm,"roleDesc",t)},expression:"addForm.roleDesc"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addRoles}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改角色",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.editForm.roleName,callback:function(t){e.$set(e.editForm,"roleName",t)},expression:"editForm.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.editForm.roleDesc,callback:function(t){e.$set(e.editForm,"roleDesc",t)},expression:"editForm.roleDesc"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.saveRolesInfo}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"分配权限",visible:e.setRightDialogVisible,width:"50%"},on:{"update:visible":function(t){e.setRightDialogVisible=t}}},[r("el-tree",{ref:"tree",attrs:{data:e.rightTree,props:e.treeProp,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defaultCheckedKeys}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setRightDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.saveRights}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(c,u,!1,function(e){r("pBuW")},"data-v-cc867eb2",null);t.default=d.exports},"c/Tr":function(e,t,r){e.exports={default:r("5zde"),__esModule:!0}},fBQ2:function(e,t,r){"use strict";var a=r("evD5"),s=r("X8DO");e.exports=function(e,t,r){t in e?a.f(e,t,s(0,r)):e[t]=r}},pBuW:function(e,t){},qgtK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),o=r.n(n),i={mixins:[{data:function(){return{rightsList:[]}},created:function(){this.getRightsList()},methods:{getRightsList:function(){var e=this;return o()(s.a.mark(function t(){var r,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rights/list");case 2:if(r=t.sent,200===(a=r.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取权限列表失败！"));case 6:e.rightsList=a.data;case 7:case"end":return t.stop()}},t,e)}))()}}}]},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限列表")])],1),e._v(" "),r("el-card",[r("el-table",{attrs:{data:e.rightsList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"权限名称",prop:"authName"}}),e._v(" "),r("el-table-column",{attrs:{label:"路径",prop:"path"}}),e._v(" "),r("el-table-column",{attrs:{label:"权限等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.level?r("el-tag",[e._v("一级")]):1==t.row.level?r("el-tag",{attrs:{type:"success"}},[e._v("二级")]):r("el-tag",{attrs:{type:"warning"}},[e._v("三级")])]}}])})],1)],1)],1)},staticRenderFns:[]},c=r("VU/8")(i,l,!1,null,null,null);t.default=c.exports},qyJz:function(e,t,r){"use strict";var a=r("+ZMJ"),s=r("kM2E"),n=r("sB3e"),o=r("msXi"),i=r("Mhyx"),l=r("QRG4"),c=r("fBQ2"),u=r("3fs2");s(s.S+s.F*!r("dY0y")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,s,d,f=n(e),m="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,b=0,h=u(f);if(v&&(g=a(g,p>2?arguments[2]:void 0,2)),void 0==h||m==Array&&i(h))for(r=new m(t=l(f.length));t>b;b++)c(r,b,v?g(f[b],b):f[b]);else for(d=h.call(f),r=new m;!(s=d.next()).done;b++)c(r,b,v?o(d,g,[s.value,b],!0):s.value);return r.length=b,r}})}});
//# sourceMappingURL=3.8042eb75e3da7fbfe47f.js.map