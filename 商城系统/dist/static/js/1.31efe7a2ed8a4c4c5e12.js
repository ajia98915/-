webpackJsonp([1],{"83Us":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),o={mixins:[{data:function(){return{cateList:[],selectedCateList:[],cascaderProp:{value:"cat_id",label:"cat_name",children:"children"},activeName:"many",isok:!0,manyTableData:[],onlyTableData:[],addDialogVisible:!1,addForm:{attr_name:""},addFormRules:{attr_name:[{required:!0,message:"请添加参数名称",trigger:"blur"}]},editDialogVisible:!1,editForm:{attr_name:""},editFormRules:{attr_name:[{required:!0,message:"请添加参数名称",trigger:"blur"}]},inputVisible:!1,inputValue:""}},created:function(){this.getCateList()},methods:{getCateList:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories",{params:{type:3}});case 2:if(a=t.sent,200===(r=a.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取商品分类失败！"));case 6:e.cateList=r.data;case 7:case"end":return t.stop()}},t,e)}))()},handleChange:function(){3!==this.selectedCateList.length?(this.selectedCateList=[],this.manyTableData=[],this.onlyTableData=[]):this.getTableData()},getTableData:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories/"+e.cateId+"/attributes",{params:{sel:e.activeName}});case 2:if(a=t.sent,200===(r=a.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取数据失败！"));case 6:r.data.forEach(function(e){var t=e.attr_vals?e.attr_vals.split(" "):[];e.attr_vals=t}),"many"===e.activeName?e.manyTableData=r.data:e.onlyTableData=r.data,console.log(r);case 9:case"end":return t.stop()}},t,e)}))()},tabClicked:function(){this.cateId&&this.getTableData()},addDialogClosed:function(){this.$refs.addFormRef.resetFields()},addParams:function(){var e,t=this;this.$refs.addFormRef.validate((e=i()(n.a.mark(function e(a){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,t.$http.post("categories/"+t.cateId+"/attributes",{attr_name:t.addForm.attr_name,attr_sel:t.activeName});case 4:if(r=e.sent,201===r.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("添加参数失败！"));case 8:t.getTableData(),t.addDialogVisible=!1;case 10:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},showEditDialog:function(e){var t=this;return i()(n.a.mark(function a(){var r,s;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.get("categories/"+t.cateId+"/attributes/"+e.attr_id,{params:{attr_sel:t.activeName}});case 2:if(r=a.sent,200===(s=r.data).meta.status){a.next=6;break}return a.abrupt("return",t.$message.error("获取参数信息失败！"));case 6:console.log(s),t.editForm=s.data,t.editDialogVisible=!0;case 9:case"end":return a.stop()}},a,t)}))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},saveEdit:function(){var e,t=this;this.$refs.editFormRef.validate((e=i()(n.a.mark(function e(a){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.put("categories/"+t.cateId+"/attributes/"+t.editForm.attr_id,{attr_name:t.editForm.attr_name,attr_sel:t.activeName});case 4:if(r=e.sent,200===r.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("更新参数信息失败！"));case 8:t.$message.success("更新参数信息成功！"),t.editDialogVisible=!1,t.getTableData();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},remove:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("此操作将永久删除该参数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===a.sent){a.next=5;break}return a.abrupt("return",t.$message({type:"info",message:"已取消删除"}));case 5:return a.next=7,t.$http.delete("categories/"+t.cateId+"/attributes/"+e);case 7:if(r=a.sent,200===r.data.meta.status){a.next=11;break}return a.abrupt("return",t.$message.error("删除参数失败！"));case 11:t.$message.success("删除参数成功！"),t.getTableData();case 13:case"end":return a.stop()}},a,t)}))()},handleInputConfirm:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==t.inputValue.trim().length){a.next=4;break}return t.inputValue="",t.inputVisible=!1,a.abrupt("return");case 4:return e.attr_vals.push(t.inputValue.trim()),t.inputValue="",t.inputVisible=!1,a.next=9,t.$http.put("categories/"+e.cat_id+"/attributes/"+e.attr_id,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")});case 9:if(r=a.sent,200===r.data.meta.status){a.next=13;break}return a.abrupt("return",t.$message.error("更新参数失败！"));case 13:case"end":return a.stop()}},a,t)}))()},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},tagClosed:function(e,t){var a=this;return i()(n.a.mark(function r(){var s;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.attr_vals.splice(t,1),r.next=3,a.$http.put("categories/"+e.cat_id+"/attributes/"+e.attr_id,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")});case 3:if(s=r.sent,200===s.data.meta.status){r.next=7;break}return r.abrupt("return",a.$message.error("更新参数失败！"));case 7:case"end":return r.stop()}},r,a)}))()}},computed:{isDisabled:function(){return 3!==this.selectedCateList.length},cateId:function(){return 3===this.selectedCateList.length?this.selectedCateList[2]:null}},watch:{selectedCateList:function(){if(3===this.selectedCateList.length)return this.isok=!1;this.isok=!0}}}]},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("参数列表")])],1),e._v(" "),a("el-card",[a("el-alert",{attrs:{title:"注意：只允许为第三级分类设置相关参数！",type:"warning","show-icon":"",closable:!1}}),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("span",[e._v("选择商品分类：")]),e._v(" "),a("el-cascader",{attrs:{"expand-trigger":"hover",options:e.cateList,props:e.cascaderProp},on:{change:e.handleChange},model:{value:e.selectedCateList,callback:function(t){e.selectedCateList=t},expression:"selectedCateList"}})],1)],1),e._v(" "),a("el-tabs",{on:{"tab-click":e.tabClicked},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isDisabled},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加参数")]),e._v(" "),a("el-table",{attrs:{data:e.manyTableData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.attr_vals,function(r,n){return a("el-tag",{key:n,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){e.tagClosed(t.row,n)}}},[e._v("\n                "+e._s(r)+"\n              ")])}),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){e.handleInputConfirm(t.row)}},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.handleInputConfirm(t.row)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ New Tag")])]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){e.showEditDialog(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){e.remove(t.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isDisabled},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加属性")]),e._v(" "),a("el-table",{attrs:{data:e.onlyTableData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.attr_vals,function(r,n){return a("el-tag",{key:n,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){e.tagClosed(t.row,n)}}},[e._v("\n                "+e._s(r)+"\n              ")])}),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){e.handleInputConfirm(t.row)}},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.handleInputConfirm(t.row)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ New Tag")])]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){e.showEditDialog(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){e.remove(t.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"many"===e.activeName?"添加动态参数":"添加静态属性",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[a("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"many"===e.activeName?"动态参数":"静态属性",prop:"attr_name"}},[a("el-input",{model:{value:e.addForm.attr_name,callback:function(t){e.$set(e.addForm,"attr_name",t)},expression:"addForm.attr_name"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addParams}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"many"===e.activeName?"修改动态参数":"修改静态属性",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[a("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"many"===e.activeName?"动态参数":"静态属性",prop:"attr_name"}},[a("el-input",{model:{value:e.editForm.attr_name,callback:function(t){e.$set(e.editForm,"attr_name",t)},expression:"editForm.attr_name"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(e){a("vQJW")},"data-v-77c5192e",null);t.default=c.exports},SYKZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),o=a("DEN3"),l=a.n(o),c=a("PbPb"),u=a.n(c),d={mixins:[{data:function(){return{activeName:"0",addForm:{goods_name:"",goods_cat:[],goods_price:"",goods_number:"",goods_weight:"",goods_introduce:"",pics:[],attrs:[]},addFormRules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_cat:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},cateList:[],cascaderProp:{value:"cat_id",label:"cat_name",children:"children"},manyTableData:[],onlyTableData:[],uploadURL:l.a.baseURL+"upload",headerObj:{Authorization:window.sessionStorage.getItem("token")},previewVisible:!1,previewImgPath:""}},created:function(){this.getCateList()},methods:{getCateList:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories",{params:{type:3}});case 2:if(a=t.sent,200===(r=a.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取商品分类失败！"));case 6:e.cateList=r.data;case 7:case"end":return t.stop()}},t,e)}))()},handleChange:function(){console.log(this.addForm.goods_cat),3===this.addForm.goods_cat.length?console.log(this.addForm):this.addForm.goods_cat=[]},beforeTabLeave:function(e,t){if("0"===t&&null===this.cateId)return this.$message.error("请先选择商品分类！"),!1},tabClicked:function(){var e=this;return i()(n.a.mark(function t(){var a,r,s,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("1"!==e.activeName){t.next=11;break}return t.next=3,e.$http.get("categories/"+e.cateId+"/attributes",{params:{sel:"many"}});case 3:if(a=t.sent,200===(r=a.data).meta.status){t.next=7;break}return t.abrupt("return",e.$message.error("获取动态参数失败！"));case 7:r.data.forEach(function(e){e.attr_vals=e.attr_vals?e.attr_vals.split(" "):[]}),e.manyTableData=r.data,t.next=20;break;case 11:if("2"!==e.activeName){t.next=20;break}return t.next=14,e.$http.get("categories/"+e.cateId+"/attributes",{params:{sel:"only"}});case 14:if(s=t.sent,200===(i=s.data).meta.status){t.next=18;break}return t.abrupt("return",e.$message.error("获取静态属性失败！"));case 18:e.onlyTableData=i.data,console.log(i);case 20:case"end":return t.stop()}},t,e)}))()},handlePreview:function(e){this.previewImgPath=e.response.data.url,this.previewVisible=!0},handleRemove:function(e){var t=e.response.data.tmp_path,a=this.addForm.pics.findIndex(function(e){return e.pic===t});this.addForm.pics.splice(a,1)},handleSuccess:function(e){if(200===e.meta.status){var t={pic:e.data.tmp_path};this.addForm.pics.push(t)}},addGoods:function(){var e,t=this;this.$refs.addFormRef.validate((e=i()(n.a.mark(function e(a){var r,s,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",t.$message.error("请完善表单数据后再添加！"));case 2:return(r=u.a.cloneDeep(t.addForm)).goods_cat=r.goods_cat.join(","),t.manyTableData.forEach(function(e){var t={attr_id:e.attr_id,attr_value:e.attr_vals.join(" ")};r.attrs.push(t)}),t.onlyTableData.forEach(function(e){var t={attr_id:e.attr_id,attr_value:e.attr_vals};r.attrs.push(t)}),e.next=8,t.$http.post("goods",r).catch(function(e){return e});case 8:if(s=e.sent,201===(i=s.data).meta.status){e.next=12;break}return e.abrupt("return",t.$message.error(i.meta.msg));case 12:t.$message.success("添加商品成功！"),t.$router.push("/goods/list");case 14:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}},computed:{cateId:function(){return 3===this.addForm.goods_cat.length?this.addForm.goods_cat[2]:null}}}]},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("添加商品")])],1),e._v(" "),a("el-card",[a("el-alert",{attrs:{title:"添加商品信息",type:"info",center:"","show-icon":"",closable:!1}}),e._v(" "),a("el-steps",{attrs:{active:e.activeName-0,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"基本信息"}}),e._v(" "),a("el-step",{attrs:{title:"商品参数"}}),e._v(" "),a("el-step",{attrs:{title:"商品属性"}}),e._v(" "),a("el-step",{attrs:{title:"商品图片"}}),e._v(" "),a("el-step",{attrs:{title:"商品内容"}}),e._v(" "),a("el-step",{attrs:{title:"完成"}})],1),e._v(" "),a("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"100px","label-position":"top"}},[a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.beforeTabLeave},on:{"tab-click":e.tabClicked},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{model:{value:e.addForm.goods_name,callback:function(t){e.$set(e.addForm,"goods_name",t)},expression:"addForm.goods_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[a("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_price,callback:function(t){e.$set(e.addForm,"goods_price",t)},expression:"addForm.goods_price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[a("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_weight,callback:function(t){e.$set(e.addForm,"goods_weight",t)},expression:"addForm.goods_weight"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input",{attrs:{type:"number"},model:{value:e.addForm.goods_number,callback:function(t){e.$set(e.addForm,"goods_number",t)},expression:"addForm.goods_number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品分类",prop:"goods_cat"}},[a("el-cascader",{attrs:{"expand-trigger":"hover",options:e.cateList,props:e.cascaderProp},on:{change:e.handleChange},model:{value:e.addForm.goods_cat,callback:function(t){e.$set(e.addForm,"goods_cat",t)},expression:"addForm.goods_cat"}})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manyTableData,function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-checkbox-group",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}},e._l(t.attr_vals,function(e,t){return a("el-checkbox",{key:t,attrs:{border:"",label:e}})}))],1)})),e._v(" "),a("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlyTableData,function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-input",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}})],1)})),e._v(" "),a("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[a("el-upload",{attrs:{action:e.uploadURL,headers:e.headerObj,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[a("quill-editor",{ref:"myQuillEditor",model:{value:e.addForm.goods_introduce,callback:function(t){e.$set(e.addForm,"goods_introduce",t)},expression:"addForm.goods_introduce"}}),e._v(" "),a("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")])],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"图片预览",visible:e.previewVisible,width:"50%"},on:{"update:visible":function(t){e.previewVisible=t}}},[a("img",{staticClass:"previewImg",attrs:{src:e.previewImgPath,alt:""}})])],1)},staticRenderFns:[]};var p=a("VU/8")(d,m,!1,function(e){a("wBOT")},"data-v-1ba68b6d",null);t.default=p.exports},ZhwZ:function(e,t){},hd2p:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),o={mixins:[{data:function(){return{queryInfo:{type:3,pagenum:1,pagesize:5},total:0,cateList:[],columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",prop:"cat_deleted",type:"template",template:"isok"},{label:"排序",prop:"cat_level",type:"template",template:"order"},{label:"操作",type:"template",template:"opt",width:"200px"}],addCateDialogVisible:!1,addForm:{cat_pid:0,cat_name:"",cat_level:0},addFormRules:{cat_name:[{required:!0,message:"请添加分类名称",trigger:"blur"}]},parentCateList:[],cascaderProp:{value:"cat_id",label:"cat_name",children:"children"},selectedCateList:[],editCateDialogVisible:!1,editForm:{cat_name:""},editFormRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}}},created:function(){this.getCateList()},methods:{getCateList:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories",{params:e.queryInfo});case 2:if(a=t.sent,200===(r=a.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取分类列表失败！"));case 6:e.cateList=r.data.result,e.total=r.data.total;case 8:case"end":return t.stop()}},t,e)}))()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getCateList()},showAddCateDialog:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.addForm.cat_pid),t.next=3,e.$http.get("categories",{params:{type:2}});case 3:if(a=t.sent,200===(r=a.data).meta.status){t.next=7;break}return t.abrupt("return",e.$message.error("获取父级分类失败！"));case 7:e.parentCateList=r.data,console.log(r.data),e.addCateDialogVisible=!0;case 10:case"end":return t.stop()}},t,e)}))()},cascaderChanged:function(){console.log(this.selectedCateList),0===this.selectedCateList.length?(this.addForm.cat_pid=0,this.addForm.cat_level=0):(this.addForm.cat_pid=this.selectedCateList[this.selectedCateList.length-1],this.addForm.cat_level=this.selectedCateList.length),console.log(this.addForm.cat_pid)},addDialogClosed:function(){this.$refs.addFormRef.resetFields(),this.selectedCateList=[],this.addForm.cat_pid=0,this.addForm.cat_level=0},addCate:function(){var e,t=this;this.$refs.addFormRef.validate((e=i()(n.a.mark(function e(a){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("categories",t.addForm);case 4:if(r=e.sent,201===r.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("添加分类失败！"));case 8:t.$message.success("添加分类成功！"),t.addCateDialogVisible=!1,t.getCateList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},showEditDialog:function(e){var t=this;return i()(n.a.mark(function a(){var r,s;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.get("categories/"+e);case 2:if(r=a.sent,200===(s=r.data).meta.status){a.next=6;break}return a.abrupt("return",t.$message.error("获取分类数据失败！"));case 6:t.editForm=s.data,t.editCateDialogVisible=!0;case 8:case"end":return a.stop()}},a,t)}))()},editDialogClosed:function(){this.$refs.editFormRef.resetFields()},saveCateInfo:function(){var e,t=this;this.$refs.editFormRef.validate((e=i()(n.a.mark(function e(a){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.put("categories/"+t.editForm.cat_id,{cat_name:t.editForm.cat_name});case 4:if(r=e.sent,200===r.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("更新分类失败！"));case 8:t.$message.success("更新分类成功！"),t.editCateDialogVisible=!1,t.getCateList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},remove:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===a.sent){a.next=5;break}return a.abrupt("return",t.$message({type:"info",message:"已取消删除"}));case 5:return a.next=7,t.$http.delete("categories/"+e);case 7:if(r=a.sent,200===r.data.meta.status){a.next=11;break}return a.abrupt("return",t.$message.error("删除分类失败！"));case 11:t.$message.success("删除分类成功！"),t.getCateList();case 13:case"end":return a.stop()}},a,t)}))()}}}]},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品分类")])],1),e._v(" "),a("el-card",[a("el-button",{attrs:{type:"primary"},on:{click:e.showAddCateDialog}},[e._v("添加分类")]),e._v(" "),a("tree-table",{staticStyle:{"margin-top":"15px"},attrs:{data:e.cateList,columns:e.columns,border:"","selection-type":!1,"expand-type":!1,"show-index":"","index-text":"#"},scopedSlots:e._u([{key:"isok",fn:function(e){return[!1===e.row.cat_deleted?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#20B2AA"}}):a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"red"}})]}},{key:"order",fn:function(t){return[0===t.row.cat_level?a("el-tag",{attrs:{size:"mini"}},[e._v("一级")]):1===t.row.cat_level?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("二级")]):a("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v("三级")])]}},{key:"opt",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){e.showEditDialog(t.row.cat_id)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){e.remove(t.row.cat_id)}}},[e._v("删除")])]}}])}),e._v(" "),a("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-size":e.queryInfo.pagesize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加分类",visible:e.addCateDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addCateDialogVisible=t},close:e.addDialogClosed}},[a("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分类名称：",prop:"cat_name"}},[a("el-input",{model:{value:e.addForm.cat_name,callback:function(t){e.$set(e.addForm,"cat_name",t)},expression:"addForm.cat_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"父级分类："}},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{"expand-trigger":"hover",options:e.parentCateList,props:e.cascaderProp,"change-on-select":"",clearable:""},on:{change:e.cascaderChanged},model:{value:e.selectedCateList,callback:function(t){e.selectedCateList=t},expression:"selectedCateList"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addCateDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addCate}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改分类",visible:e.editCateDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editCateDialogVisible=t},close:e.editDialogClosed}},[a("el-form",{ref:"editFormRef",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分类名称：",prop:"cat_name"}},[a("el-input",{model:{value:e.editForm.cat_name,callback:function(t){e.$set(e.editForm,"cat_name",t)},expression:"editForm.cat_name"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editCateDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveCateInfo}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(e){a("ZhwZ")},"data-v-758a8782",null);t.default=c.exports},"mYB+":function(e,t){},vQJW:function(e,t){},vsaQ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),o={mixins:[{data:function(){return{queryInfo:{query:"",pagenum:1,pagesize:10},goodsList:[],total:0}},created:function(){this.getGoodsList()},methods:{getGoodsList:function(){var e=this;return i()(n.a.mark(function t(){var a,r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("goods",{params:e.queryInfo});case 2:if(a=t.sent,200===(r=a.data).meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取商品列表失败！"));case 6:e.goodsList=r.data.goods,e.total=r.data.total;case 8:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getGoodsList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getGoodsList()},remove:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("此操作将永久删除该商品, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===a.sent){a.next=5;break}return a.abrupt("return",t.$message({type:"info",message:"已取消删除"}));case 5:return a.next=7,t.$http.delete("goods/"+e);case 7:if(r=a.sent,200===r.data.meta.status){a.next=11;break}return a.abrupt("return",t.$message.error("删除商品失败！"));case 11:t.$message.success("删除商品成功！"),t.getGoodsList();case 13:case"end":return a.stop()}},a,t)}))()},goAddPage:function(){this.$router.push("/goods/add")}}}]},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品列表")])],1),e._v(" "),a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getGoodsList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getGoodsList},slot:"append"})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:e.goAddPage}},[e._v("添加商品")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.goodsList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"商品名称",prop:"goods_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"商品价格(元)",prop:"goods_price",width:"95px"}}),e._v(" "),a("el-table-column",{attrs:{label:"商品重量",prop:"goods_weight",width:"70px"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"add_time",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("dateFormat")(t.row.add_time))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){e.remove(t.row.goods_id)}}})]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[5,10,20,30],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(e){a("mYB+")},"data-v-72b897fa",null);t.default=c.exports},wBOT:function(e,t){}});
//# sourceMappingURL=1.31efe7a2ed8a4c4c5e12.js.map